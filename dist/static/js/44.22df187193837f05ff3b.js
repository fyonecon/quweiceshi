webpackJsonp([44],{fumB:function(t,e){},yVfh:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("y+mr");var a=n("3JdW"),i=n.n(a),o=n("Xxa5"),s=n.n(o),r=(n("qONS"),n("UQTY")),c=n.n(r),l=n("//Fk"),u=n.n(l),p=(n("34+y"),n("X+yh")),h=n.n(p),m=n("exGp"),d=n.n(m),f=n("pjeT"),v=n("mS0+"),w=n("psC7"),g=n("0oWP"),x=n("KvKp"),_=n("JAv/"),b=n("fxnj"),k=n.n(b),y={data:function(){return function(){if("onhashchange"in window){console.log("该浏览器支持hashchange事件!生成第一个展示页面");var t={time:(new Date).getTime()};window.history.pushState(t,"","http://localhost:8080/dist/index.html#/shqs?")}}(),{step:1,nickname:"",sex:"",options:{showRadio:!1,showInput:!0},result:"",count:"",show:!1}},beforeRouteEnter:function(t,e,n){n(function(e){Object(_.a)(1).then(function(e){Object(x.a)(t)})})},mounted:function(){this.$nextTick(function(){window.scrollTo(0,0)})},methods:{close:function(){this.show=!1},toResult:function(){var t=this;return d()(s.a.mark(function e(){var n,a,i,o,r,l,p,m,d,f;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.nickname.trim()){e.next=3;break}return h()("请输入姓名"),e.abrupt("return");case 3:return h()("加载中.."),n=t,(a=Math.round(35*Math.random()))<10&&(a="0"+a,console.log(a)),i="http://quweifiles.mukzz.pw/web-project/shqs/"+a+".jpg",o="http://qwapi_ywfbt.mukzz.pw/public/?s=/api/jump/jp",console.log(i),r=window.location.href,l=run_only(r),o=o+"/p/"+l,console.log(o),p=get_user_ip(),console.log(p),o=o+"/ip/"+p,console.log(o),h()("加载中.."),e.next=23,Object(x.b)(o);case 23:m=e.sent,d=document.createElement("canvas"),f=d.getContext("2d"),new u.a(function(t,e){var n=new Image;n.crossOrigin="anonymous",n.src=i,n.onload=function(){d.width=n.width,d.height=n.height,f.drawImage(n,0,0,n.width,n.height),t()}}).then(function(){return new u.a(function(t,e){var n=new Image;n.crossOrigin="anonymous",n.src=m,n.onload=function(){f.drawImage(n,255,694,110,110),t()}})}).then(function(){return new u.a(function(e,n){f.font="30px 微软雅黑",f.fillStyle="#c90000",f.textAlign="center",f.textBaseline="top",f.fillTextVertical(t.nickname,512,87),e()})}).then(function(){n.result=d.toDataURL("image/jpeg"),c.a.close(),window.scrollTo(0,0),run_btn_cal(),Object(x.e)()?t.show=!0:k.a.previewImage({current:n.result,urls:[n.result]})});case 27:case"end":return e.stop()}},e,t)}))()}},components:{List:f.a,"mt-button":i.a,scriptRender:g.a,FixedBottom:v.a,preview:w.a}};CanvasRenderingContext2D.prototype.fillTextVertical=function(t,e,n){var a=this,i=(a.canvas,t.split("")),o=i.map(function(t){return a.measureText(t).width}),s=a.textAlign,r=a.textBaseline;"left"==s?e+=Math.max.apply(null,o)/2:"right"==s&&(e-=Math.max.apply(null,o)/2),"bottom"==r||"alphabetic"==r||"ideographic"==r?n-=o[0]/2:"top"!=r&&"hanging"!=r||(n+=o[0]/2),a.textAlign="center",a.textBaseline="middle",i.forEach(function(i,s){var r=o[s];i.charCodeAt(0)<=256?(a.translate(e,n),a.rotate(90*Math.PI/180),a.translate(-e,-n)):s>0&&t.charCodeAt(s-1)<256&&(n+=o[s-1]/2),a.fillText(i,e,n),a.setTransform(1,0,0,1,0,0);r=o[s];n+=r}),a.textAlign=s,a.textBaseline=r},window.addEventListener("popstate",function(){console.log("监听返回按钮。同时生成第二个展示页面");window.location.replace("http://localhost:8080/dist/index.html#/?")});var C={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"web-index"},[n("div",{staticClass:"title"},[t._v("\n    三行情书\n  ")]),t._v(" "),n("div",{staticClass:"container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:1===t.step,expression:"step===1"}],staticClass:"p1"},[n("img",{staticClass:"cover-img",attrs:{src:"http://quweifiles.mukzz.pw/web-project/shqs/cover.jpg",alt:""}}),t._v(" "),t._m(0),t._v(" "),t.options.showInput?n("input",{directives:[{name:"model",rawName:"v-model",value:t.nickname,expression:"nickname"}],staticClass:"input",attrs:{type:"text",maxlength:"4",placeholder:"请输入姓名"},domProps:{value:t.nickname},on:{input:function(e){e.target.composing||(t.nickname=e.target.value)}}}):t._e(),t._v(" "),n("mt-button",{staticClass:"btn-submit btn-ok",attrs:{type:"danger",size:"large"},on:{click:t.toResult}},[t._v("确 定")])],1)]),t._v(" "),n("list"),t._v(" "),n("div",{staticClass:"btn-box"},[n("mt-button",{staticClass:"scale",attrs:{type:"primary",size:"large"},on:{click:function(e){t.$router.push("/")}}},[t._v("更多测试 "),n("i",{staticClass:"iconfont icon-next"})])],1),t._v(" "),n("fixed-bottom"),t._v(" "),n("preview",{attrs:{pic:t.result,show:t.show},on:{close:t.close}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"small-title"},[this._v("赶快去生成吧")]),this._v(" "),e("div",{staticClass:"small-title-txt"},[this._v("三行情书，爱你，只用三行字来表达。毕竟，纸短情长。")])])}]};var j=n("VU/8")(y,C,!1,function(t){n("fumB")},"data-v-3a104778",null);e.default=j.exports}});